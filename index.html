<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ“‹ Equipment Maintenance</title>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
  <style>
    body {
      padding: 20px;
    }
    .dataTables_wrapper .dataTables_filter {
      float: right;
      text-align: right;
    }
    table.dataTable td {
      white-space: nowrap;
    }
    th, td {
      font-size: 14px;
    }
    .modal input, .modal textarea {
      font-size: 14px;
    }
    .modal-title {
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h4><img src="https://cdn-icons-png.flaticon.com/512/942/942748.png" width="24"> Equipment Maintenance</h4>

  <button class="btn btn-success mb-2" id="addBtn">âž• Add</button>

  <table id="equipmentTable" class="display table table-bordered table-striped">
    <thead>
      <tr>
        <th>No</th>
        <th>Activity</th>
        <th>Equip</th>
        <th>Model</th>
        <th>Downtime *</th>
        <th>Comp Code</th>
        <th>Resp</th>
        <th>Remaks</th>
        <th>Est RFU</th>
        <th>Aging</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Modal -->
  <div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <form id="inputForm">
          <div class="modal-header">
            <h5 class="modal-title" id="addModalLabel">Add Equipment Maintenance</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>
          </div>
          <div class="modal-body">
            <div class="form-row">
              <div class="form-group col-md-4">
                <label>Activity</label>
                <input type="text" class="form-control" name="Activity" required>
              </div>
              <div class="form-group col-md-4">
                <label>Equip</label>
                <input type="text" class="form-control" name="Equip" required>
              </div>
              <div class="form-group col-md-4">
                <label>Model</label>
                <input type="text" class="form-control" name="Model" required>
              </div>
              <div class="form-group col-md-4">
                <label>Downtime *</label>
                <input type="date" class="form-control" name="Downtime" required>
              </div>
              <div class="form-group col-md-4">
                <label>Comp Code</label>
                <input type="text" class="form-control" name="CompCode">
              </div>
              <div class="form-group col-md-4">
                <label>Resp</label>
                <input type="text" class="form-control" name="Resp">
              </div>
              <div class="form-group col-md-4">
                <label>Est RFU</label>
                <input type="date" class="form-control" name="EstRFU">
              </div>
              <div class="form-group col-md-8">
                <label>Remaks</label>
                <textarea class="form-control" name="Remaks" rows="2"></textarea>
              </div>
              <div class="form-group col-md-4">
                <label>Aging</label>
                <input type="number" class="form-control" name="Aging">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Save</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- JS Section -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
  <script>
    let table;
    let no = 1;

    $(document).ready(function () {
      table = $('#equipmentTable').DataTable();

      $('#addBtn').click(function () {
        $('#inputForm')[0].reset();
        $('#addModal').modal('show');
      });

      $('#inputForm').submit(function (e) {
        e.preventDefault();
        const formData = $(this).serializeArray();
        const dataObj = {};
        formData.forEach(item => dataObj[item.name] = item.value);
        
        table.row.add([
          no++,
          dataObj.Activity,
          dataObj.Equip,
          dataObj.Model,
          dataObj.Downtime,
          dataObj.CompCode,
          dataObj.Resp,
          dataObj.Remaks.replace(/\n/g, "<br>"),
          dataObj.EstRFU,
          dataObj.Aging,
          '<button class="btn btn-danger btn-sm deleteBtn">Hapus</button>'
        ]).draw(false);

        $('#addModal').modal('hide');
      });

      $('#equipmentTable tbody').on('click', '.deleteBtn', function () {
        table.row($(this).parents('tr')).remove().draw();
      });
    });
  </script>

</body>
</html>
